flowchart TD

    subgraph sg_Calc_COGS["Calc_COGS"]
        sect_Calc_COGS_0["COST OF GOODS SOLD"]
        sect_Calc_COGS_1["RAW MATERIALS ($000s)"]
        sect_Calc_COGS_2["PACKAGING ($000s)"]
        sect_Calc_COGS_3["DIRECT MANUFACTURING ($000s)"]
        sect_Calc_COGS_4["TOTAL COGS ($000s)"]
        sect_Calc_COGS_5["KEY METRICS"]
    end
    ext_in_Assum_Costs(["Assum_Costs"])
    ext_in_Assum_Costs -- "Base Scenario, Downside Scenario" --> sect_Calc_COGS_0
    ext_in_Assum_Costs -- "Hops, Malt & Adjuncts..." --> sect_Calc_COGS_1
    ext_in_Assum_Costs -- "Bottles (glass, labels, caps, cartons), Cans (aluminum, labels, cartons)..." --> sect_Calc_COGS_2
    ext_in_Assum_Costs -- "Direct Labour, Manufacturing Overhead..." --> sect_Calc_COGS_3
    ext_in_Calc_Revenue(["Calc_Revenue"])
    ext_in_Calc_Revenue -- "Net Revenue" --> sect_Calc_COGS_5
    ext_in_Calc_Volume(["Calc_Volume"])
    ext_in_Calc_Volume -- "Date, Period" --> sect_Calc_COGS_0
    ext_in_Calc_Volume -- "Total" --> sect_Calc_COGS_1
    ext_in_Calc_Volume -- "Bottles, Cans..." --> sect_Calc_COGS_2
    ext_in_Calc_Volume -- "Total" --> sect_Calc_COGS_3
    ext_in_Calc_Volume -- "Total" --> sect_Calc_COGS_5
    ext_in_Control(["Control"])
    ext_in_Control -- "Active Scenario (1=Base, 2=Upside, 3=Downside)" --> sect_Calc_COGS_0
    sect_Calc_COGS_0 -- "Cost Index (cumulative)" --> sect_Calc_COGS_1
    sect_Calc_COGS_0 -- "Cost Index (cumulative)" --> sect_Calc_COGS_2
    sect_Calc_COGS_0 -- "Cost Index (cumulative)" --> sect_Calc_COGS_3
    sect_Calc_COGS_1 -- "Total Raw Materials" --> sect_Calc_COGS_4
    sect_Calc_COGS_2 -- "Total Packaging" --> sect_Calc_COGS_4
    sect_Calc_COGS_3 -- "Total Direct Manufacturing" --> sect_Calc_COGS_4
    sect_Calc_COGS_4 -- "Total COGS" --> sect_Calc_COGS_5
    ext_out_Annual_Summary(["Annual_Summary"])
    sect_Calc_COGS_4 -- "Total COGS" --> ext_out_Annual_Summary
    ext_out_Calc_Opex(["Calc_Opex"])
    sect_Calc_COGS_0 -- "Cost Index (cumulative)" --> ext_out_Calc_Opex
    ext_out_Calc_WC(["Calc_WC"])
    sect_Calc_COGS_4 -- "Total COGS" --> ext_out_Calc_WC
    ext_out_IS(["IS"])
    sect_Calc_COGS_1 -- "Total Raw Materials" --> ext_out_IS
    sect_Calc_COGS_2 -- "Total Packaging" --> ext_out_IS
    sect_Calc_COGS_3 -- "Total Direct Manufacturing" --> ext_out_IS
    sect_Calc_COGS_4 -- "Total COGS" --> ext_out_IS